wget ftp://ftp.ncbi.nlm.nih.gov/pub/taxonomy/taxdump.tar.gz
tar xvzf taxdump.tar.gz
wget ftp://ftp.ncbi.nih.gov/pub/taxonomy/accession2taxid/nucl_gb.accession2taxid.gz
gunzip nucl_gb.accession2taxid.gz

grep ">" 2020-09_GenbankSnakeMito.fasta | sed 's/ .*//g' | sed 's/>//g' > accessions
sed '1d' nucl_gb.accession2taxid | cut -f2,3 > taxmap
#grep -f accessions nucl_gb.accession2taxid | cut -f2,3 > taxmap

grep -w ^8715 names.dmp | grep "scientific name" | cut -f3


# Try acc2tax
mkdir taxdb
tar xvzf taxdump.tar.gz -C taxdb
sort nucl_gb.accession2taxid > taxdb/acc2tax_nucl_all.txt

# Downloaded gff3 and made taxmap
grep "taxon:" 2020-09_GenbankSnakeMito.gff3 | sed 's/\t.*taxon\:/\t/g' | sed 's/[,;].*$//g' > taxmap
#Error: [makeblastdb] No sequences matched any of the taxids provided.



# Trying to figure out phylogenetic distance
dist = pd.DataFrame({'name':[], 'dist':[]})
names = []
dists = []
for rec in tree.get_terminals():
    dists.append(tree.distance("I16458_Bothrops_andianus_ATP6_len_681__9143",rec))
    names.append(rec.name.replace("_*",""))